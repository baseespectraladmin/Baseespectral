<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Base espectral - Base de Datos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
</head>
<body>

<header>
    <div class="navbar">
        <div class="logo" onclick="mostrarSeccion('home')">Base espectral</div>
        <div class="menu-icon" onclick="toggleMenu()">☰</div>
        
        <nav id="nav-menu">
            <ul>
                <li><a onclick="mostrarSeccion('home'); toggleMenu()">Home</a></li>
                <li class="has-dropdown">
                    <a class="nav-link">Espectros ▾</a>
                    <div class="dropdown">
                        <a onclick="mostrarSeccion('espectros-absorbancia'); toggleMenu()">Espectros de absorbancia</a>
                        <a onclick="mostrarSeccion('espectros-reflexion'); toggleMenu()">Espectros de reflexión difusa</a>
                    </div>
                </li>
                <li class="has-dropdown">
                    <a class="nav-link">Artículos ▾</a>
                    <div class="dropdown">
                        <a onclick="mostrarSeccion('art-difusion'); toggleMenu()">Artículos de difusión</a>
                        <a onclick="mostrarSeccion('art-investigacion'); toggleMenu()">Artículos de investigación</a>
                        <a onclick="mostrarSeccion('art-referencias'); toggleMenu()">Artículos de referencias</a>
                    </div>
                </li>
                <li class="has-dropdown">
                    <a class="nav-link">Reflexión Difusa ▾</a>
                    <div class="dropdown">
                        <a onclick="mostrarSeccion('ref-agricola'); toggleMenu()">Reflexión Difusa</a>
                        <a onclick="mostrarSeccion('ref-aplicada'); toggleMenu()">Reflexión Difusa agrícola aplicada</a>
                        <a onclick="mostrarSeccion('ref-simulada'); toggleMenu()">Reflexión Difusa agrícola simulada</a>
                    </div>
                </li>
                <li class="has-dropdown">
                    <a class="nav-link">Fluorescencia ▾</a>
                    <div class="dropdown">
                        <span class="menu-separator">Fluorescencia Médica</span>
                        <a onclick="mostrarSeccion('fluo-med-aplicada'); toggleMenu()">F. Médica Aplicada</a>
                        <a onclick="mostrarSeccion('fluo-med-simulada'); toggleMenu()">F. Médica Simulada</a>
                        
                        <span class="menu-separator">Fluorescencia Agrícola</span>
                        <a onclick="mostrarSeccion('fluo-agri-aplicada'); toggleMenu()">F. Agrícola Aplicada</a>
                        <a onclick="mostrarSeccion('fluo-agri-simulada'); toggleMenu()">F. Agrícola Simulada</a>
                    </div>
                </li>
                <li><a onclick="mostrarSeccion('seccion-login'); toggleMenu()" id="nav-login">Admin Login</a></li>
                <li id="nav-subir" style="display: none;">
                    <a onclick="mostrarSeccion('seccion-subir'); toggleMenu()" style="color: var(--verde-acento);">+ Subir</a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<div id="home" class="seccion-contenido seccion-activa">
    <section class="hero">
        <h1>Firmas ópticas trazables para monitoreo agrícola y periurbano.</h1>
        <p>Biblioteca de firmas ópticas (UV–Vis–NIR) para la Base espectral.</p>
    </section>
    <main class="container">
        <section class="grid">
            <div class="card" onclick="mostrarSeccion('espectros-reflexion')">
                <h3>Espectros de Reflexión</h3>
                <p>Visualiza gráficas interactivas de reflectancia.</p>
            </div>
            <div class="card" onclick="mostrarSeccion('art-investigacion')">
                <h3>Artículos Científicos</h3>
                <p>Repositorio vinculado a datos espectrales.</p>
            </div>
        </section>
    </main>
</div>

<div id="seccion-login" class="seccion-contenido container">
    <div class="login-card">
        <h2>Acceso Administrativo</h2>
        <div class="form-group">
            <label>Usuario:</label>
            <input type="text" id="admin-user" placeholder="Usuario">
        </div>
        <div class="form-group">
            <label>Contraseña:</label>
            <input type="password" id="admin-pass" placeholder="Contraseña">
        </div>
        <button onclick="verificarAdmin()" class="btn-subir">Entrar</button>
        <p id="error-login" style="color: red; display: none; margin-top: 10px; text-align: center;"></p>
    </div>
</div>

<div id="seccion-subir" class="seccion-contenido container">
    <div class="form-subida">
        <h2 id="titulo-form">Subir Nuevo Artículo</h2>
        <form id="formArticulo">
            <label>Título:</label>
            <input type="text" id="titulo" required placeholder="Título del trabajo">
            
            <label>Autores:</label>
            <input type="text" id="autores" required placeholder="Autores">
            
            <label>Fecha de Publicación:</label>
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <input type="number" id="anio" required placeholder="Año (2026)" style="flex:2;">
                <input type="number" id="mes" placeholder="Mes" min="1" max="12" style="flex:1;">
                <input type="number" id="dia" placeholder="Día" min="1" max="31" style="flex:1;">
            </div>

            <label>Categoría:</label>
            <select id="categoria" required style="margin-bottom: 15px;" onchange="ajustarTipoEntrada()">
                <optgroup label="Artículos">
                    <option value="art-investigacion">Artículos de Investigación</option>
                    <option value="art-difusion">Artículos de Difusión</option>
                    <option value="art-referencias">Artículos de Referencias</option>
                </optgroup>
                <optgroup label="Reflexión">
                    <option value="ref-agricola">Reflexión Difusa</option>
                    <option value="ref-aplicada">Reflexión Difusa Agrícola Aplicada</option>
                    <option value="ref-simulada">Reflexión Difusa Agrícola Simulada</option>
                </optgroup>
                <optgroup label="Fluorescencia Médica">
                    <option value="fluo-med-aplicada">F. Médica Aplicada</option>
                    <option value="fluo-med-simulada">F. Médica Simulada</option>
                </optgroup>
                <optgroup label="Fluorescencia Agrícola">
                    <option value="fluo-agri-aplicada">F. Agrícola Aplicada</option>
                    <option value="fluo-agri-simulada">F. Agrícola Simulada</option>
                </optgroup>
            </select>

            <div id="contenedor-pdf">
                <label>Archivo (PDF):</label>
                <input type="file" id="archivo" accept=".pdf">
            </div>

            <div id="contenedor-url" style="display: none;">
                <label>Enlace Externo (URL):</label>
                <input type="url" id="enlace_externo" placeholder="https://ejemplo.com/articulo">
            </div>
            
            <button type="submit" class="btn-subir">Guardar en Base espectral</button>
        </form>
    </div>
</div>

<div id="espectros-absorbancia" class="seccion-contenido container">
    <h1>Espectros de Absorbancia</h1><hr>
    <div id="lista-espectros-absorbancia" class="lista-container"></div>
</div>

<div id="espectros-reflexion" class="seccion-contenido container">
    <h1>Espectros de Reflexión Difusa</h1><hr>
    <div style="position: relative; width: 100%; margin-top: 20px;">
        <div id="grafica-reflexion" style="width:100%; height:500px; background: white; border-radius: 15px;"></div>
        <div id="custom-tooltip" style="position:absolute; pointer-events:none; display:none; transform: translate(-50%, -115%); z-index:1000;">
            <div style="width:240px; height:65px; border-radius:8px; overflow:hidden; box-shadow:0 6px 18px rgba(0,0,0,0.25); position:relative;">
                <div style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex;">
                    <div style="width:33.3%; background:#006847;"></div>
                    <div style="width:33.3%; background:#ffffff;"></div>
                    <div style="width:33.3%; background:#ce1126;"></div>
                </div>
                <div style="position:relative; z-index:2; padding:10px; color:#000; font-weight:600; text-align:center; background:rgba(255,255,255,0.4);">
                    <div>λ: <span id="lambda-value">--</span> nm</div>
                    <div>Ref: <span id="refl-value">--</span> %</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="art-investigacion" class="seccion-contenido container"><h1>Artículos de Investigación</h1><hr><div id="lista-art-investigacion" class="lista-container"></div></div>
<div id="art-difusion" class="seccion-contenido container"><h1>Artículos de Difusión</h1><hr><div id="lista-art-difusion" class="lista-container"></div></div>
<div id="art-referencias" class="seccion-contenido container"><h1>Artículos de Referencias</h1><hr><div id="lista-art-referencias" class="lista-container"></div></div>

<div id="ref-agricola" class="seccion-contenido container"><h1>Reflexión Difusa</h1><hr><div id="lista-ref-agricola" class="lista-container"></div></div>
<div id="ref-aplicada" class="seccion-contenido container"><h1>Reflexión Difusa Agrícola Aplicada</h1><hr><div id="lista-ref-aplicada" class="lista-container"></div></div>
<div id="ref-simulada" class="seccion-contenido container"><h1>Reflexión Difusa Agrícola Simulada</h1><hr><div id="lista-ref-simulada" class="lista-container"></div></div>

<div id="fluo-med-aplicada" class="seccion-contenido container"><h1>Fluorescencia Médica Aplicada</h1><hr><div id="lista-fluo-med-aplicada" class="lista-container"></div></div>
<div id="fluo-med-simulada" class="seccion-contenido container"><h1>Fluorescencia Médica Simulada</h1><hr><div id="lista-fluo-med-simulada" class="lista-container"></div></div>
<div id="fluo-agri-aplicada" class="seccion-contenido container"><h1>Fluorescencia Agrícola Aplicada</h1><hr><div id="lista-fluo-agri-aplicada" class="lista-container"></div></div>
<div id="fluo-agri-simulada" class="seccion-contenido container"><h1>Fluorescencia Agrícola Simulada</h1><hr><div id="lista-fluo-agri-simulada" class="lista-container"></div></div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/app.js"></script>
</body>
</html>